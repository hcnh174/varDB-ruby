<#import "/global.ftl" as vardb>

<@vardb.layout title="Map" location={'Map':'/map.html'} cur="map">

<p class="introduction">
Distribution of sequences by country/geographic region.
</p>
<br/>

<div id="map" style="width: 600px; height: 343px"></div>
<br/>
<div id="griddiv"></div>

<br/>

<@vardb.comments type="PAGE" identifier="map"/>

<@vardb.addScript url="http://www.google.com/jsapi?key=${vardb.gmapkey}" addparam=false/>
<@vardb.addScript>
google.load("maps", "2.x");

var countries=
{
	rows:
	[
		<#list countries as country>
		{
			id: ${country.id?c},
			identifier: '${country.identifier?js_string}',
			region: '${country.region.title?js_string}',
			iso: '${country.iso?default('')}',
			lat: ${country.latitude?default(0)?c},
			lng: ${country.longitude?default(0)?c},
			numsequences: ${country.numsequences?c}
		}<#if country_has_next>,</#if>
		</#list>
	]
};
</@vardb.addScript>

<@vardb.onReady>
	var grid=new Ext.ux.vardb.Countries({data: countries, renderTo: 'griddiv'});
	var map=new Ext.ux.vardb.Map({data: countries, applyTo: 'map'});
</@vardb.onReady>

</@vardb.layout>